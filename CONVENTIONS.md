I am working on a Python project using functional programming principles. Please follow these coding conventions:

1. Write pure functions with no side effects, and manage state through functions and closures rather than classes.
2. Keep the code compact and focused, with each function doing one thing well.
3. Use one-line docstrings sparingly, only when they add significant clarity.
4. Handle errors gracefully with meaningful exceptions.

For testing:
1. Ensure comprehensive test coverage, focusing on both typical and edge cases.
2. Use `unittest` and follow a single responsibility principle for each test case.
3. Include tests for concurrency, resource limits, invalid inputs, and unusual state changes.
4. Ensure clear and concise assertions in your tests, and validate that exceptions are raised where expected.

